From b389a5265341a2e25693f72e6d2d8992f24552c0 Mon Sep 17 00:00:00 2001
From: linya14x <linx.yang@intel.com>
Date: Fri, 14 Nov 2025 18:41:08 +0800
Subject: [PATCH 4/6] staging: ipu7: Update IPU7 firmware ABI version to
 1.2.1.20251215_224531

Signed-off-by: Hao Yao <hao.yao@intel.com>
---
 drivers/staging/media/ipu7/abi/ipu7_fw_boot_abi.h |  1 +
 drivers/staging/media/ipu7/abi/ipu7_fw_isys_abi.h | 11 +++++++----
 drivers/staging/media/ipu7/abi/ipu7_fw_msg_abi.h  |  2 +-
 3 files changed, 9 insertions(+), 5 deletions(-)

diff --git a/drivers/staging/media/ipu7/abi/ipu7_fw_boot_abi.h b/drivers/staging/media/ipu7/abi/ipu7_fw_boot_abi.h
index a1519c4fe661..4ce304f54e4b 100644
--- a/drivers/staging/media/ipu7/abi/ipu7_fw_boot_abi.h
+++ b/drivers/staging/media/ipu7/abi/ipu7_fw_boot_abi.h
@@ -153,6 +153,7 @@ enum ia_gofo_boot_state {
 	IA_GOFO_FW_BOOT_STATE_CRIT_MPU_CONFIG_FAILURE = 0xdead1013U,
 	IA_GOFO_FW_BOOT_STATE_CRIT_SHARED_BUFFER_FAILURE = 0xdead1014U,
 	IA_GOFO_FW_BOOT_STATE_CRIT_CMEM_FAILURE = 0xdead1015U,
+	IA_GOFO_FW_BOOT_STATE_CRIT_SYSCOM_CONTEXT_FAILURE = 0xDEAD1016U,
 	IA_GOFO_FW_BOOT_STATE_SHUTDOWN_CMD = 0x57a7f001U,
 	IA_GOFO_FW_BOOT_STATE_SHUTDOWN_START = 0x57a7e200U,
 	IA_GOFO_FW_BOOT_STATE_INACTIVE = 0x57a7e300U,
diff --git a/drivers/staging/media/ipu7/abi/ipu7_fw_isys_abi.h b/drivers/staging/media/ipu7/abi/ipu7_fw_isys_abi.h
index c42d0b7a2627..7f622bfe9af6 100644
--- a/drivers/staging/media/ipu7/abi/ipu7_fw_isys_abi.h
+++ b/drivers/staging/media/ipu7/abi/ipu7_fw_isys_abi.h
@@ -47,7 +47,6 @@ enum ipu7_insys_resp_type {
 	IPU_INSYS_RESP_TYPE_FRAME_EOF = 8,
 	IPU_INSYS_RESP_TYPE_STREAM_START_AND_CAPTURE_DONE = 9,
 	IPU_INSYS_RESP_TYPE_STREAM_CAPTURE_DONE = 10,
-	IPU_INSYS_RESP_TYPE_PWM_IRQ = 11,
 	N_IPU_INSYS_RESP_TYPE
 };

@@ -201,7 +200,8 @@ enum ipu7_insys_mipi_dt_rename_mode {
 enum ipu7_insys_output_link_dest {
 	IPU_INSYS_OUTPUT_LINK_DEST_MEM = 0,
 	IPU_INSYS_OUTPUT_LINK_DEST_PSYS = 1,
-	IPU_INSYS_OUTPUT_LINK_DEST_IPU_EXTERNAL = 2
+	IPU_INSYS_OUTPUT_LINK_DEST_IPU_EXTERNAL = 2,
+	N_IPU_INSYS_OUTPUT_LINK_DEST
 };

 enum ipu7_insys_dpcm_type {
@@ -220,9 +220,12 @@ enum ipu7_insys_dpcm_predictor {

 enum ipu7_insys_send_queue_token_flag {
 	IPU_INSYS_SEND_QUEUE_TOKEN_FLAG_NONE = 0,
-	IPU_INSYS_SEND_QUEUE_TOKEN_FLAG_FLUSH_FORCE = 1
+	IPU_INSYS_SEND_QUEUE_TOKEN_FLAG_FLUSH_FORCE = 1,
+	N_IPU_INSYS_SEND_QUEUE_TOKEN_FLAG
 };

+#define IPU_INSYS_MIPI_FRAME_NUMBER_DONT_CARE UINT16_MAX
+
 #pragma pack(push, 1)
 struct ipu7_insys_resolution {
 	u32 width;
@@ -312,7 +315,7 @@ struct ipu7_insys_resp {
 	u8 pin_id;
 	u8 frame_id;
 	u8 skip_frame;
-	u8 pad[2];
+	u16 mipi_fn;
 };

 struct ipu7_insys_resp_queue_token {
diff --git a/drivers/staging/media/ipu7/abi/ipu7_fw_msg_abi.h b/drivers/staging/media/ipu7/abi/ipu7_fw_msg_abi.h
index 8a78dd0936df..1319f0eb6319 100644
--- a/drivers/staging/media/ipu7/abi/ipu7_fw_msg_abi.h
+++ b/drivers/staging/media/ipu7/abi/ipu7_fw_msg_abi.h
@@ -217,7 +217,7 @@ struct ipu7_msg_task {
 	u8 frag_id;
 	u8 req_done_msg;
 	u8 req_done_irq;
-	u8 reserved[1];
+	u8 disable_save;
 	ipu7_msg_teb_t payload_reuse_bm;
 	ia_gofo_addr_t term_buffers[IPU_MSG_MAX_NODE_TERMS];
 };
--
2.43.0

